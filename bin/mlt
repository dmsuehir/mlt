#!/usr/bin/env python
"""mlt.
Usage:
  mlt (-h | --help)
  mlt --version
  mlt init [--template=<template>] [--registry=<registry>] <name>
  mlt build [--watch]
  mlt deploy
  mlt undeploy
  mlt (template | templates) list

Options:
  --template=<template> Template name for app
                        initialization [default: hello-world].
  --registry=<registry> Container registry to use.
                        If none is set, will attempt to use gcloud.
"""
import sys
import os

from docopt import docopt

from mlt.commands import build, deploy, init, templates, undeploy


def main():
    args = docopt(__doc__, version="ML Container Templates v0.0.1")

    if args["init"]:
        init.init(args)
    elif args["build"]:
        if not os.path.isfile('mlt.json'):
            print("`mlt build` requires you to be in a `mlt init` "
                  "built directory.")
            sys.exit(1)
        else:
            build.build(args)
    elif args["deploy"]:
        if not os.path.isfile('mlt.json'):
            print("`mlt deploy` requires you to be in a `mlt init` "
                  "built directory.")
            sys.exit(1)
        else:
            deploy.deploy(args)
    elif (args["template"] or args["templates"]) and args["list"]:
        templates.templates_list()
    elif args["undeploy"]:
        undeploy.undeploy(args)


if __name__ == '__main__':
    main()
